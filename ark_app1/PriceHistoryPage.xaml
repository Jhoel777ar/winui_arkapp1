<Page
    x:Class="ark_app1.PriceHistoryPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="using:CommunityToolkit.WinUI.UI.Controls">

    <Grid Padding="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Spacing="10" Margin="0,0,0,15">
            <TextBlock Text="Historial de Cambios de Precio (Por Compra)" Style="{StaticResource TitleTextBlockStyle}"/>
            <TextBox x:Name="SearchBox" PlaceholderText="Buscar por producto..."
                     TextChanged="SearchBox_TextChanged" Width="300" HorizontalAlignment="Left"/>
        </StackPanel>

        <controls:DataGrid x:Name="DataGrid" Grid.Row="1" ItemsSource="{x:Bind Records}"
                           AutoGenerateColumns="False" IsReadOnly="True"
                           GridLinesVisibility="Horizontal">
            <controls:DataGrid.Columns>
                <controls:DataGridTemplateColumn Header="Fecha" Width="140">
                    <controls:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Fecha, Converter={StaticResource DateTimeToStringConverter}}"/>
                        </DataTemplate>
                    </controls:DataGridTemplateColumn.CellTemplate>
                </controls:DataGridTemplateColumn>
                <controls:DataGridTextColumn Header="Compra ID" Binding="{Binding CompraId}"/>
                <controls:DataGridTextColumn Header="Código" Binding="{Binding Codigo}"/>
                <controls:DataGridTextColumn Header="Producto" Binding="{Binding Producto}" Width="*"/>
                <controls:DataGridTextColumn Header="Cant. Comprada" Binding="{Binding Cantidad}"/>
                <controls:DataGridTextColumn Header="P. Compra" Binding="{Binding PrecioCompraDisplay}"/>
                <controls:DataGridTextColumn Header="P. Venta Actual" Binding="{Binding PrecioVentaDisplay}"/>
                <controls:DataGridTextColumn Header="Usuario" Binding="{Binding Usuario}"/>
            </controls:DataGrid.Columns>
        </controls:DataGrid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center" Margin="0,10,0,0">
            <Button x:Name="PrevButton" Content="Anterior" Click="PrevButton_Click"/>
            <TextBlock x:Name="PageInfo" Text="Página 1 de 1" VerticalAlignment="Center"/>
            <Button x:Name="NextButton" Content="Siguiente" Click="NextButton_Click"/>
        </StackPanel>
    </Grid>
</Page>
